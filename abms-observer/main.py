{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "96cb01aa-8ae0-4bc7-948d-a3c19fbc3415",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pynetlogo\n",
    "import time\n",
    "import random\n",
    "from selenium import webdriver\n",
    "from selenium.webdriver.common.by import By"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "c2130c2f-828e-4d9f-84a8-298b258a7452",
   "metadata": {},
   "outputs": [],
   "source": [
    "driver = webdriver.Chrome()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "05eb76f7-2ef9-48be-b404-f5640ffdfb3b",
   "metadata": {},
   "outputs": [
    {
     "ename": "WebDriverException",
     "evalue": "Message: unknown error: net::ERR_CONNECTION_REFUSED\n  (Session info: chrome=132.0.6834.160)\nStacktrace:\n\tGetHandleVerifier [0x00007FF69FCE02F5+28725]\n\t(No symbol) [0x00007FF69FC42AE0]\n\t(No symbol) [0x00007FF69FAD510A]\n\t(No symbol) [0x00007FF69FAD2861]\n\t(No symbol) [0x00007FF69FAC3559]\n\t(No symbol) [0x00007FF69FAC52AF]\n\t(No symbol) [0x00007FF69FAC381F]\n\t(No symbol) [0x00007FF69FAC32ED]\n\t(No symbol) [0x00007FF69FAC2FBA]\n\t(No symbol) [0x00007FF69FAC0DD1]\n\t(No symbol) [0x00007FF69FAC145C]\n\t(No symbol) [0x00007FF69FAD824A]\n\t(No symbol) [0x00007FF69FB70FAE]\n\t(No symbol) [0x00007FF69FB4FFAA]\n\t(No symbol) [0x00007FF69FB70181]\n\t(No symbol) [0x00007FF69FB4FD53]\n\t(No symbol) [0x00007FF69FB1A0E3]\n\t(No symbol) [0x00007FF69FB1B471]\n\tGetHandleVerifier [0x00007FF6A000F30D+3366989]\n\tGetHandleVerifier [0x00007FF6A00212F0+3440688]\n\tGetHandleVerifier [0x00007FF6A00178FD+3401277]\n\tGetHandleVerifier [0x00007FF69FDAAAAB+858091]\n\t(No symbol) [0x00007FF69FC4E74F]\n\t(No symbol) [0x00007FF69FC4A304]\n\t(No symbol) [0x00007FF69FC4A49D]\n\t(No symbol) [0x00007FF69FC38B69]\n\tBaseThreadInitThunk [0x00007FFB1566E8D7+23]\n\tRtlUserThreadStart [0x00007FFB168DBF2C+44]\n",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mWebDriverException\u001b[0m                        Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[3], line 1\u001b[0m\n\u001b[1;32m----> 1\u001b[0m \u001b[43mdriver\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mget\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43mhttps://localhost:44387/Home.aspx\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m)\u001b[49m\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\selenium\\webdriver\\remote\\webdriver.py:356\u001b[0m, in \u001b[0;36mWebDriver.get\u001b[1;34m(self, url)\u001b[0m\n\u001b[0;32m    354\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21mget\u001b[39m(\u001b[38;5;28mself\u001b[39m, url: \u001b[38;5;28mstr\u001b[39m) \u001b[38;5;241m-\u001b[39m\u001b[38;5;241m>\u001b[39m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m    355\u001b[0m \u001b[38;5;250m    \u001b[39m\u001b[38;5;124;03m\"\"\"Loads a web page in the current browser session.\"\"\"\u001b[39;00m\n\u001b[1;32m--> 356\u001b[0m     \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mexecute\u001b[49m\u001b[43m(\u001b[49m\u001b[43mCommand\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mGET\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m{\u001b[49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43murl\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m:\u001b[49m\u001b[43m \u001b[49m\u001b[43murl\u001b[49m\u001b[43m}\u001b[49m\u001b[43m)\u001b[49m\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\selenium\\webdriver\\remote\\webdriver.py:347\u001b[0m, in \u001b[0;36mWebDriver.execute\u001b[1;34m(self, driver_command, params)\u001b[0m\n\u001b[0;32m    345\u001b[0m response \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcommand_executor\u001b[38;5;241m.\u001b[39mexecute(driver_command, params)\n\u001b[0;32m    346\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m response:\n\u001b[1;32m--> 347\u001b[0m     \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43merror_handler\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mcheck_response\u001b[49m\u001b[43m(\u001b[49m\u001b[43mresponse\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m    348\u001b[0m     response[\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mvalue\u001b[39m\u001b[38;5;124m\"\u001b[39m] \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_unwrap_value(response\u001b[38;5;241m.\u001b[39mget(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mvalue\u001b[39m\u001b[38;5;124m\"\u001b[39m, \u001b[38;5;28;01mNone\u001b[39;00m))\n\u001b[0;32m    349\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m response\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\selenium\\webdriver\\remote\\errorhandler.py:229\u001b[0m, in \u001b[0;36mErrorHandler.check_response\u001b[1;34m(self, response)\u001b[0m\n\u001b[0;32m    227\u001b[0m         alert_text \u001b[38;5;241m=\u001b[39m value[\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124malert\u001b[39m\u001b[38;5;124m\"\u001b[39m]\u001b[38;5;241m.\u001b[39mget(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mtext\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m    228\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m exception_class(message, screen, stacktrace, alert_text)  \u001b[38;5;66;03m# type: ignore[call-arg]  # mypy is not smart enough here\u001b[39;00m\n\u001b[1;32m--> 229\u001b[0m \u001b[38;5;28;01mraise\u001b[39;00m exception_class(message, screen, stacktrace)\n",
      "\u001b[1;31mWebDriverException\u001b[0m: Message: unknown error: net::ERR_CONNECTION_REFUSED\n  (Session info: chrome=132.0.6834.160)\nStacktrace:\n\tGetHandleVerifier [0x00007FF69FCE02F5+28725]\n\t(No symbol) [0x00007FF69FC42AE0]\n\t(No symbol) [0x00007FF69FAD510A]\n\t(No symbol) [0x00007FF69FAD2861]\n\t(No symbol) [0x00007FF69FAC3559]\n\t(No symbol) [0x00007FF69FAC52AF]\n\t(No symbol) [0x00007FF69FAC381F]\n\t(No symbol) [0x00007FF69FAC32ED]\n\t(No symbol) [0x00007FF69FAC2FBA]\n\t(No symbol) [0x00007FF69FAC0DD1]\n\t(No symbol) [0x00007FF69FAC145C]\n\t(No symbol) [0x00007FF69FAD824A]\n\t(No symbol) [0x00007FF69FB70FAE]\n\t(No symbol) [0x00007FF69FB4FFAA]\n\t(No symbol) [0x00007FF69FB70181]\n\t(No symbol) [0x00007FF69FB4FD53]\n\t(No symbol) [0x00007FF69FB1A0E3]\n\t(No symbol) [0x00007FF69FB1B471]\n\tGetHandleVerifier [0x00007FF6A000F30D+3366989]\n\tGetHandleVerifier [0x00007FF6A00212F0+3440688]\n\tGetHandleVerifier [0x00007FF6A00178FD+3401277]\n\tGetHandleVerifier [0x00007FF69FDAAAAB+858091]\n\t(No symbol) [0x00007FF69FC4E74F]\n\t(No symbol) [0x00007FF69FC4A304]\n\t(No symbol) [0x00007FF69FC4A49D]\n\t(No symbol) [0x00007FF69FC38B69]\n\tBaseThreadInitThunk [0x00007FFB1566E8D7+23]\n\tRtlUserThreadStart [0x00007FFB168DBF2C+44]\n"
     ]
    }
   ],
   "source": [
    "driver.get(\"https://localhost:44387/Home.aspx\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "45af8486-e968-4dba-84f1-8b83e88fb809",
   "metadata": {},
   "outputs": [],
   "source": [
    "netlogo = pynetlogo.NetLogoLink(gui=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "16652ef1-7680-4678-aced-eeb1fb26e032",
   "metadata": {},
   "outputs": [],
   "source": [
    "netlogo.load_model(r\"C:\\Users\\Maria Paula\\Downloads\\Thesis\\ABMS\\Apartment-12.nlogo\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d8b922d5-faac-414d-b6b7-e95ba1ef96f1",
   "metadata": {},
   "outputs": [],
   "source": [
    "netlogo.command(\"setup\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a5cab746-91ff-4f57-9b94-bec161641be7",
   "metadata": {},
   "outputs": [],
   "source": [
    "xcor = netlogo.report(\"[xcor] of person 0\")\n",
    "ycor = netlogo.report(\"[ycor] of person 0\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "604190f2-952f-40a5-b295-59645607b1bf",
   "metadata": {},
   "outputs": [],
   "source": [
    "print(\"The current coordinates of the person are\", xcor, ycor) # With the needs being considered, the person starts the simulation in bed"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "1e84a587-7e19-429e-8f9e-ecaaae7009b5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#netlogo.command(\"repeat 5 [go]\")\n",
    "#netlogo.command(repeat \"go\")\n",
    "netlogo.repeat_command(\"go\", 10)\n",
    "#print(netlogo.repeat_report([\"ticks\"], 1))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "b2e96fa4-bda1-47c1-a274-8621fc81a583",
   "metadata": {},
   "outputs": [
    {
     "ename": "PermissionError",
     "evalue": "[WinError 32] The process cannot access the file because it is being used by another process: 'C:\\\\Users\\\\Maria Paula\\\\Downloads\\\\Thesis\\\\Python\\\\ABMS observer\\\\qa2dn3_5\\\\tmpso81jqan.txt'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mPermissionError\u001b[0m                           Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[9], line 2\u001b[0m\n\u001b[0;32m      1\u001b[0m status \u001b[38;5;241m=\u001b[39m netlogo\u001b[38;5;241m.\u001b[39mreport(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m[shape] of person 0\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[1;32m----> 2\u001b[0m \u001b[43mnetlogo\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mrepeat_report\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43m[shape] of person 0\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m100\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43mgo\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43;01mTrue\u001b[39;49;00m\u001b[43m)\u001b[49m\n\u001b[0;32m      3\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m status \u001b[38;5;241m==\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mfallen\u001b[39m\u001b[38;5;124m\"\u001b[39m:\n\u001b[0;32m      4\u001b[0m     \u001b[38;5;28mprint\u001b[39m(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mThe person has fallen down to the ground.\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\pynetlogo\\core.py:557\u001b[0m, in \u001b[0;36mNetLogoLink.repeat_report\u001b[1;34m(self, netlogo_reporter, reps, go, include_t0)\u001b[0m\n\u001b[0;32m    553\u001b[0m                 result \u001b[38;5;241m=\u001b[39m np\u001b[38;5;241m.\u001b[39marray([entry\u001b[38;5;241m.\u001b[39mstrip(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m'\u001b[39m) \u001b[38;5;28;01mfor\u001b[39;00m entry \u001b[38;5;129;01min\u001b[39;00m result\u001b[38;5;241m.\u001b[39msplit()])\n\u001b[0;32m    555\u001b[0m         results[key] \u001b[38;5;241m=\u001b[39m result\n\u001b[1;32m--> 557\u001b[0m     \u001b[43mos\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mremove\u001b[49m\u001b[43m(\u001b[49m\u001b[43mvalue\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m    559\u001b[0m \u001b[38;5;66;03m# cleanup temp files and folders\u001b[39;00m\n\u001b[0;32m    560\u001b[0m \u001b[38;5;28;01mfor\u001b[39;00m fh \u001b[38;5;129;01min\u001b[39;00m fhs:\n",
      "\u001b[1;31mPermissionError\u001b[0m: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\\\Users\\\\Maria Paula\\\\Downloads\\\\Thesis\\\\Python\\\\ABMS observer\\\\qa2dn3_5\\\\tmpso81jqan.txt'"
     ]
    }
   ],
   "source": [
    "status = netlogo.report(\"[shape] of person 0\")\n",
    "netlogo.repeat_report(\"[shape] of person 0\", 100, \"go\", True)\n",
    "if status == \"fallen\":\n",
    "    print(\"The person has fallen down to the ground.\")\n",
    "    driver.find_element(By.ID, \"fall\").click() # Implicit interaction is triggered\n",
    "if status == \"person\":\n",
    "    print(\"The person is okay.\") # Nothing happens"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "f0f0521b-5b8c-4cf2-84be-bbcbc1316cd4",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "82.0\n"
     ]
    }
   ],
   "source": [
    "age = netlogo.report(\"[age] of person 0\")\n",
    "print(int(age))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "f3910382-6782-4daa-8700-a1c777f50fc9",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "14\n"
     ]
    }
   ],
   "source": [
    "if (age <= 40):\n",
    "    random_int = random.randint(2, 7)\n",
    "    print(random_int)\n",
    "if (40 < age < 60):\n",
    "    random_int = random.randint(4, 12)\n",
    "    print(random_int)\n",
    "if (age >= 60):\n",
    "    random_int = random.randint(8, 18)\n",
    "    print(random_int)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "4c8a1a09-d355-4aab-b6e4-8af6eb94e869",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "14\n"
     ]
    }
   ],
   "source": [
    "sec = random_int\n",
    "print(sec)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "fe84b84f-2027-47ad-8bc8-03cf9a946f55",
   "metadata": {},
   "outputs": [
    {
     "ename": "PermissionError",
     "evalue": "[WinError 32] The process cannot access the file because it is being used by another process: 'C:\\\\Users\\\\Maria Paula\\\\Downloads\\\\Thesis\\\\Python\\\\ABMS observer\\\\uf7ec90s\\\\tmp7ua4egta.txt'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mPermissionError\u001b[0m                           Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[13], line 7\u001b[0m\n\u001b[0;32m      5\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[0;32m      6\u001b[0m     sec \u001b[38;5;241m=\u001b[39m \u001b[38;5;241m2\u001b[39m\n\u001b[1;32m----> 7\u001b[0m \u001b[43mnetlogo\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mrepeat_report\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43m[used-app] of person 0\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m100\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43mgo\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43;01mTrue\u001b[39;49;00m\u001b[43m)\u001b[49m\n\u001b[0;32m      8\u001b[0m \u001b[38;5;66;03m#if number > 5:\u001b[39;00m\n\u001b[0;32m      9\u001b[0m     \u001b[38;5;66;03m# Doesn't use the software application\u001b[39;00m\n\u001b[0;32m     10\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m number \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m5\u001b[39m: \u001b[38;5;66;03m# No message\u001b[39;00m\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\pynetlogo\\core.py:557\u001b[0m, in \u001b[0;36mNetLogoLink.repeat_report\u001b[1;34m(self, netlogo_reporter, reps, go, include_t0)\u001b[0m\n\u001b[0;32m    553\u001b[0m                 result \u001b[38;5;241m=\u001b[39m np\u001b[38;5;241m.\u001b[39marray([entry\u001b[38;5;241m.\u001b[39mstrip(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m'\u001b[39m) \u001b[38;5;28;01mfor\u001b[39;00m entry \u001b[38;5;129;01min\u001b[39;00m result\u001b[38;5;241m.\u001b[39msplit()])\n\u001b[0;32m    555\u001b[0m         results[key] \u001b[38;5;241m=\u001b[39m result\n\u001b[1;32m--> 557\u001b[0m     \u001b[43mos\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mremove\u001b[49m\u001b[43m(\u001b[49m\u001b[43mvalue\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m    559\u001b[0m \u001b[38;5;66;03m# cleanup temp files and folders\u001b[39;00m\n\u001b[0;32m    560\u001b[0m \u001b[38;5;28;01mfor\u001b[39;00m fh \u001b[38;5;129;01min\u001b[39;00m fhs:\n",
      "\u001b[1;31mPermissionError\u001b[0m: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\\\Users\\\\Maria Paula\\\\Downloads\\\\Thesis\\\\Python\\\\ABMS observer\\\\uf7ec90s\\\\tmp7ua4egta.txt'"
     ]
    }
   ],
   "source": [
    "number = netlogo.report(\"[used-app] of person 0\")\n",
    "speed = netlogo.report(\"[speed] of person 0\")\n",
    "netlogo.repeat_report(\"[used-app] of person 0\", 100, \"go\", True)\n",
    "#if number > 5:\n",
    "    # Doesn't use the software application\n",
    "if number == 5: # No message\n",
    "    time.sleep(sec)\n",
    "    driver.maximize_window()\n",
    "    time.sleep(sec)\n",
    "    driver.find_element(By.ID, \"btnConfirm\").click() # Calls help\n",
    "    time.sleep(sec)\n",
    "    driver.find_element(By.ID, \"btnConfirm\").click() # Back to homepage\n",
    "if number == 6: # Message one\n",
    "    time.sleep(sec)\n",
    "    driver.maximize_window()\n",
    "    time.sleep(sec)\n",
    "    search_box = driver.find_element(By.ID, \"txtempname\")\n",
    "    time.sleep(sec)\n",
    "    search_box.send_keys(\"I've got a headache.\")\n",
    "    time.sleep(sec)\n",
    "    driver.find_element(By.ID, \"btnConfirm\").click() \n",
    "    time.sleep(sec)\n",
    "    driver.find_element(By.ID, \"btnConfirm\").click()\n",
    "if number == 7: # Message two\n",
    "    driver.maximize_window()\n",
    "    time.sleep(sec)\n",
    "    search_box = driver.find_element(By.ID, \"txtempname\")\n",
    "    time.sleep(sec)\n",
    "    search_box.send_keys(\"I broke something.\")\n",
    "    time.sleep(sec)\n",
    "    driver.find_element(By.ID, \"btnConfirm\").click()\n",
    "    time.sleep(sec)\n",
    "    driver.find_element(By.ID, \"btnConfirm\").click()\n",
    "if number == 8: # Message three\n",
    "    driver.maximize_window()\n",
    "    time.sleep(sec)\n",
    "    search_box = driver.find_element(By.ID, \"txtempname\")\n",
    "    time.sleep(sec)\n",
    "    search_box.send_keys(\"I need help with my medication.\")\n",
    "    time.sleep(sec)\n",
    "    driver.find_element(By.ID, \"btnConfirm\").click()\n",
    "    time.sleep(sec)\n",
    "    driver.find_element(By.ID, \"btnConfirm\").click()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "e8205104-9fe6-49e8-8ecc-2198e2132288",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The person is okay.\n"
     ]
    }
   ],
   "source": [
    "status = netlogo.report(\"[shape] of person 0\")\n",
    "#print(\"status =\", status)\n",
    "if status == \"fallen\":\n",
    "    print(\"The person has fallen down to the ground.\")\n",
    "    driver.find_element(By.ID, \"fall\").click()\n",
    "if status == \"person\":\n",
    "    print(\"The person is okay.\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2c01a838-9b49-4763-9f55-984d01e29ab7",
   "metadata": {},
   "source": [
    "The following random number decides if and how the person is going to use the software application:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "f5e937fd-9c6a-476a-928a-5664d79c4174",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "5.0\n"
     ]
    }
   ],
   "source": [
    "number = netlogo.report(\"[number] of person 0\")\n",
    "print(number)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "40e620e5-93a6-40e6-842e-4b9465ad6ba6",
   "metadata": {},
   "source": [
    "The speed impacts the navigation of the person when using the software application:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "5fdaaa13-6ed1-4e7e-a2a6-448787fe8f16",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The average speed of this person is 0.15 km/h.\n"
     ]
    }
   ],
   "source": [
    "speed = netlogo.report(\"[what-speed] of person 0\")\n",
    "print(\"The average speed of this person is\", speed, \"km/h.\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "8f23da0a-08a2-41c5-8277-37b2deddfc62",
   "metadata": {},
   "outputs": [],
   "source": [
    "if speed > 0.75:\n",
    "    sec = 7\n",
    "else:\n",
    "    sec = 2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "c1ea1b17-6bfc-4adc-9f02-15c4dc6147a5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#if number > 5:\n",
    "    # Doesn't use the software application\n",
    "if number == 5: # No message\n",
    "    time.sleep(sec)\n",
    "    driver.maximize_window()\n",
    "    time.sleep(sec)\n",
    "    driver.find_element(By.ID, \"btnConfirm\").click() # Calls help\n",
    "    time.sleep(sec)\n",
    "    driver.find_element(By.ID, \"btnConfirm\").click() # Back to homepage\n",
    "if number == 6: # Message one\n",
    "    time.sleep(sec)\n",
    "    driver.maximize_window()\n",
    "    time.sleep(sec)\n",
    "    search_box = driver.find_element(By.ID, \"txtempname\")\n",
    "    time.sleep(sec)\n",
    "    search_box.send_keys(\"I've got a headache.\")\n",
    "    time.sleep(sec)\n",
    "    driver.find_element(By.ID, \"btnConfirm\").click() \n",
    "    time.sleep(sec)\n",
    "    driver.find_element(By.ID, \"btnConfirm\").click()\n",
    "if number == 7: # Message two\n",
    "    driver.maximize_window()\n",
    "    time.sleep(sec)\n",
    "    search_box = driver.find_element(By.ID, \"txtempname\")\n",
    "    time.sleep(sec)\n",
    "    search_box.send_keys(\"I broke something.\")\n",
    "    time.sleep(sec)\n",
    "    driver.find_element(By.ID, \"btnConfirm\").click()\n",
    "    time.sleep(sec)\n",
    "    driver.find_element(By.ID, \"btnConfirm\").click()\n",
    "if number == 8: # Message three\n",
    "    driver.maximize_window()\n",
    "    time.sleep(sec)\n",
    "    search_box = driver.find_element(By.ID, \"txtempname\")\n",
    "    time.sleep(sec)\n",
    "    search_box.send_keys(\"I need help with my medication.\")\n",
    "    time.sleep(sec)\n",
    "    driver.find_element(By.ID, \"btnConfirm\").click()\n",
    "    time.sleep(sec)\n",
    "    driver.find_element(By.ID, \"btnConfirm\").click()\n",
    "#if number >= 9:\n",
    "    # Wants to, but does not succeed in using the application"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "a3d2c4a3-4653-46aa-be81-b3fa279d11bf",
   "metadata": {},
   "outputs": [],
   "source": [
    "#driver.refresh()\n",
    "driver.close()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0da08934-8e3c-4b22-8523-339650ad02a9",
   "metadata": {},
   "outputs": [],
   "source": [
    "netlogo.kill_workspace()"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
